import * as tslib_1 from "tslib";
import { Component, Input } from '@angular/core';
import { GFieldValidatorType, GFieldValueType } from '../../gs-forms.enums';
import { GsGenericFieldComponent } from '../_generic-field/_generic-field.component';
// TODO: add error validators
var TwoDataInputErrors;
(function (TwoDataInputErrors) {
    TwoDataInputErrors[TwoDataInputErrors["RIGHT_MIN"] = 0] = "RIGHT_MIN";
    TwoDataInputErrors[TwoDataInputErrors["LEFT_MIN"] = 1] = "LEFT_MIN";
    TwoDataInputErrors[TwoDataInputErrors["REQUIRED"] = 2] = "REQUIRED";
})(TwoDataInputErrors || (TwoDataInputErrors = {}));
let GsTwoDataInputComponent = class GsTwoDataInputComponent extends GsGenericFieldComponent {
    constructor() {
        super(...arguments);
        this.valueType = GFieldValueType;
        this.fieldValidatorType = GFieldValidatorType;
        this.rightFieldTouched = false;
        this.leftFieldTouched = false;
    }
    ngOnChanges(changes) {
        if (changes.field.currentValue) {
            this.field = changes.field.currentValue;
            if (this.field.config.value) {
                this.leftFieldValue = this.field.config.value.left || null;
                this.rightFieldValue = this.field.config.value.right || null;
            }
            if (this.field.config.options) {
                this.leftFieldType = this.field.config.options.left ? this.field.config.options.left.type || null : null;
                this.rightFieldType = this.field.config.options.right ? this.field.config.options.right.type || null : null;
                this.leftFieldPlaceholder = this.field.config.options.left ? this.field.config.options.left.placeholder || null : null;
                this.rightFieldPlaceholder = this.field.config.options.right ? this.field.config.options.right.placeholder || null : null;
            }
        }
    }
    setGrid() {
        if (!this.field.config.grid) {
            return null;
        }
        const grid = this.field.config.grid[0] + ' max-content ' + this.field.config.grid[1];
        return { 'grid-template-columns': grid };
    }
    onUpdateValue(right) {
        if (!this.rightFieldTouched && right) {
            this.rightFieldTouched = true;
        }
        if (!this.leftFieldTouched && !right) {
            this.leftFieldTouched = true;
        }
        const updatedValue = {
            left: this.leftFieldValue,
            right: this.rightFieldValue
        };
        if (updatedValue.left && updatedValue.right) {
            this.formGroup.controls[this.field.config.model].patchValue(updatedValue);
            this.formGroup.controls[this.field.config.model].updateValueAndValidity();
        }
        else {
            this.formGroup.controls[this.field.config.model].patchValue(null);
        }
    }
    checkMinMaxValidator(input, validator) {
        if (this.field.config.options && this.field.config.options[input] && this.field.config.options[input].type) {
            if (this.field.config.options[input].type === this.valueType.NUMBER) {
                if (this.field.config.options[input].validators
                    && this.field.config.options[input].validators[this.fieldValidatorType[validator]]) {
                    return this.field.config.options[input].validators[this.fieldValidatorType[validator]];
                }
                else if (this.field.config.validators && this.field.config.validators[this.fieldValidatorType[validator]]) {
                    return this.field.config.validators[this.fieldValidatorType[validator]];
                }
            }
        }
        return null;
    }
    requiredText(right) {
        return right
            ? this.formsService.getValidationMessage('ERR_REQUIRED_TWO_DATA_RIGHT')
            : this.formsService.getValidationMessage('ERR_REQUIRED_TWO_DATA_LEFT');
    }
    validateRequired(right) {
        const input = right ? 'right' : 'left';
        return this.field.config.options[input].validators &&
            this[`${input}FieldTouched`] &&
            this.field.config.options[input].validators.required &&
            !this[`${input}FieldValue`];
    }
};
tslib_1.__decorate([
    Input()
], GsTwoDataInputComponent.prototype, "field", void 0);
GsTwoDataInputComponent = tslib_1.__decorate([
    Component({
        selector: 'gs-two-data-input',
        template: "<div class=\"gs-field\" \n  [class.gs-field-has-error]=\"validateField() || validateRequired(false) || validateRequired(true)\">\n  \n  <label\n    class=\"gs-field-box\"\n    [class.gs-form-field-box-full]=\"field.config.label\">\n\n    <span\n      class=\"gs-field-label\"\n      *ngIf=\"field.config.label\">\n      {{ field.config.label | translate }}\n    </span>\n\n    <div class=\"gs-field-input gs-field-input-two-data\" [ngStyle]=\"setGrid()\">\n      <!-- left input -->\n      <input \n        class=\"gs-field-input gs-field-input-two-data-left\" \n        [placeholder]=\"leftFieldPlaceholder || '' | translate\"\n        [type]=\"leftFieldType === valueType.NUMBER ? 'number' : 'string'\"\n        [pattern]=\"leftFieldType === valueType.NUMBER ? '[0-9]*' : null\"\n        [inputmode]=\"leftFieldType === valueType.NUMBER ? 'numeric' : null\" \n        [decimal]=\"false\"\n        [gsDigitOnly]=\"leftFieldType === valueType.NUMBER\" \n        [autocomplete]=\"field.config.autocomplete || 'off'\"\n        [(ngModel)]=\"leftFieldValue\" \n        [min]=\"checkMinMaxValidator('left', 'MIN')\" \n        [max]=\"checkMinMaxValidator('left', 'MAX')\"\n        (keyup)=\"onUpdateValue(false)\"/>\n    \n      <!-- divider -->\n      <span class=\"gs-field-input-two-data-divider\">\n        {{ field.config.divider || '-' }}\n      </span>\n    \n      <!-- right input -->\n      <input \n        class=\"gs-field-input gs-field-input-two-data-right\" \n        [placeholder]=\"rightFieldPlaceholder || '' | translate\"\n        [type]=\"rightFieldType === valueType.NUMBER ? 'number' : 'string'\"\n        [pattern]=\"rightFieldType === valueType.NUMBER ? '[0-9]*' : null\"\n        [inputmode]=\"rightFieldType === valueType.NUMBER ? 'numeric' : null\" \n        [decimal]=\"false\"\n        [gsDigitOnly]=\"rightFieldType === valueType.NUMBER\" \n        [autocomplete]=\"field.config.autocomplete || 'off'\"\n        [min]=\"checkMinMaxValidator('right', 'MIN')\" \n        [max]=\"checkMinMaxValidator('right', 'MAX')\"\n        [(ngModel)]=\"rightFieldValue\"\n        (keyup)=\"onUpdateValue(true)\"/>\n    </div>\n  </label>\n\n  <span class=\"gs-field-error\" *ngIf=\"validateField()\">\n    {{ getFieldError(field.config.model) | translate }}\n  </span>\n  <span class=\"gs-field-error\"\n    *ngIf=\"validateRequired(false)\">\n    {{ requiredText(false) }}\n  </span>\n  <span class=\"gs-field-error\"\n    *ngIf=\"validateRequired(true)\">\n    {{ requiredText(true) }}\n  </span>\n</div>",
        styles: ["*{color:var(--gs-color-font,#706967);outline:0;box-sizing:border-box}input,option,select,textarea{border:none;outline:0;display:block;box-shadow:none;box-sizing:border-box}input::-webkit-input-placeholder,option::-webkit-input-placeholder,select::-webkit-input-placeholder,textarea::-webkit-input-placeholder{opacity:.5}input::-moz-placeholder,option::-moz-placeholder,select::-moz-placeholder,textarea::-moz-placeholder{opacity:.5}input::-ms-input-placeholder,option::-ms-input-placeholder,select::-ms-input-placeholder,textarea::-ms-input-placeholder{opacity:.5}input::placeholder,option::placeholder,select::placeholder,textarea::placeholder{opacity:.5}.disabled{opacity:var(--gs-disabled-opacity,.7);cursor:default;pointer-events:none}.button{-webkit-transition:.2s ease-in-out;transition:.2s ease-in-out;cursor:pointer;border:none;text-align:center;font-weight:700;outline:0;padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-color,#fff);background:var(--gs-primary-button-background,#b8b4b4);border-radius:var(--gs-primary-button-border-radius,1rem)}.button:hover{opacity:.8}.button.button-primary{padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-color,#fff);background:var(--gs-primary-button-background,#ff2426);border:none;border-radius:var(--gs-primary-button-border-radius,1rem)}.button.button-secondary{padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-background,#ff2426);background:0 0;border:2px solid var(--gs-primary-button-background,#ff2426);border-radius:var(--gs-primary-button-border-radius,1rem)}*,input,select,textarea{font-size:var(--gs-font-size,.9rem);font-family:inherit;background-color:transparent}.gs-no-select{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gs-field{position:relative}.gs-field.gs-field-has-error .gs-field-box{border:2px solid #ff2426}.gs-field.gs-field-has-error .gs-field-error{display:block}.gs-field-box{border:2px solid var(--gs-input-border-color,none);display:-ms-grid;display:grid;background-color:var(--gs-input-background,#fff);padding:var(--gs-input-padding,12px);border-radius:var(--gs-input-border-radius,1rem);height:51px}.gs-field-box .gs-field-label{color:#706967;font-size:.6rem;font-weight:600;letter-spacing:.1em;line-height:1;text-transform:uppercase;-ms-grid-column:1;grid-column:1;-ms-grid-row:1;grid-row:1;color:var(--gs-input-color,#332927);opacity:.5}.gs-field-box .gs-field-input{outline:0;border:none;width:100%;margin:0;font-weight:600;font-size:1rem;line-height:1;padding:0;-ms-grid-column:1;grid-column:1;-ms-grid-row:2;grid-row:2}.gs-field-box .gs-field-input :focus,.gs-field-box .gs-field-input:focus{outline:0}.gs-field-box .gs-field-input::-webkit-input-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::-moz-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::-ms-input-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-form-field_symbol{-ms-grid-column:2;grid-column:2;-ms-grid-row:1;-ms-grid-row-span:2;grid-row:1/3;-ms-grid-row-align:center;align-self:center;text-align:right}.gs-field-box.gs-field-box-full .gs-field-input{padding:.1rem 0 0}.gs-field-box.gs-input-check-box,.gs-field-box.gs-input-switch-box{-ms-grid-columns:1fr auto;grid-template-columns:1fr auto}.gs-field-box.gs-input-check-box .gs-field-label,.gs-field-box.gs-input-switch-box .gs-field-label{-ms-grid-column:1;grid-column:1;-ms-grid-row:1;grid-row:1;-ms-grid-row-align:center;align-self:center}.gs-field-box.gs-input-check-box .gs-input-check,.gs-field-box.gs-input-check-box .gs-input-switch,.gs-field-box.gs-input-switch-box .gs-input-check,.gs-field-box.gs-input-switch-box .gs-input-switch{-ms-grid-column:2;grid-column:2;-ms-grid-row:1;grid-row:1;-ms-grid-row-align:center;align-self:center}.gs-field-box.gs-field-box-icon{display:-ms-grid;display:grid;-ms-grid-columns:1fr 20px;grid-template-columns:1fr 20px}.gs-field-box.gs-field-box-icon .gs-field-icon{cursor:pointer;width:20px;fill:#706967;-ms-grid-column:2;grid-column:2;-ms-grid-row:1;-ms-grid-row-span:2;grid-row:1/3;-ms-grid-row-align:center;align-self:center}.gs-field-error,.gs-field-hint{font-size:.8rem;padding:.6rem 1rem;display:inline-block;margin-right:1rem}.gs-field-error{display:none;color:#ff2426}input{background:0 0;border:none;outline:0;margin:0;width:100%}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.gs-field-input-two-data{display:-ms-grid;display:grid;-ms-grid-columns:auto -webkit-max-content auto;-ms-grid-columns:auto max-content auto;grid-template-columns:auto -webkit-max-content auto;grid-template-columns:auto max-content auto}.gs-field-input-two-data .gs-field-input-two-data-input-divider,.gs-field-input-two-data .gs-field-input-two-data-left,.gs-field-input-two-data .gs-field-input-two-data-right{-ms-grid-row:1!important;grid-row:1!important}.gs-field-input-two-data .gs-field-input-two-data-left{padding-right:.5rem;text-align:right;-ms-grid-column:1!important;grid-column:1!important}.gs-field-input-two-data .gs-field-input-two-data-left::-webkit-input-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::-moz-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::-ms-input-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-right{padding-left:.5rem;-ms-grid-column:3!important;grid-column:3!important}.gs-field-input-two-data .gs-field-input-two-data-divider{background-color:#e5e5e4;text-align:center;-ms-grid-row-align:center;align-self:center;padding:0 .5rem;-ms-grid-column:2!important;grid-column:2!important}"]
    })
], GsTwoDataInputComponent);
export { GsTwoDataInputComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHdvLWRhdGEtaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzL25nLWZvcm1zLyIsInNvdXJjZXMiOlsibGliL2dzLWZpZWxkcy90d28tZGF0YS1pbnB1dC90d28tZGF0YS1pbnB1dC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUUzRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDNUUsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNENBQTRDLENBQUM7QUFFckYsNkJBQTZCO0FBQzdCLElBQUssa0JBSUo7QUFKRCxXQUFLLGtCQUFrQjtJQUNyQixxRUFBUyxDQUFBO0lBQ1QsbUVBQVEsQ0FBQTtJQUNSLG1FQUFRLENBQUE7QUFDVixDQUFDLEVBSkksa0JBQWtCLEtBQWxCLGtCQUFrQixRQUl0QjtBQU9ELElBQWEsdUJBQXVCLEdBQXBDLE1BQWEsdUJBQXdCLFNBQVEsdUJBQXVCO0lBTHBFOztRQWNTLGNBQVMsR0FBRyxlQUFlLENBQUM7UUFDNUIsdUJBQWtCLEdBQUcsbUJBQW1CLENBQUM7UUFDekMsc0JBQWlCLEdBQUcsS0FBSyxDQUFDO1FBQzFCLHFCQUFnQixHQUFHLEtBQUssQ0FBQztJQWlGbEMsQ0FBQztJQS9FQyxXQUFXLENBQUMsT0FBc0I7UUFDaEMsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRTtZQUM5QixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDO1lBRXhDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFO2dCQUMzQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFD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QUN6RTthQUNGO1NBQ0Y7UUFFRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFTSxZQUFZLENBQUMsS0FBYztRQUNoQyxPQUFPLEtBQUs7WUFDVixDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyw2QkFBNkIsQ0FBQztZQUN2RSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUFFTSxnQkFBZ0IsQ0FBQyxLQUFjO1FBQ3BDLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFFdkMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVTtZQUNoRCxJQUFJLENBQUMsR0FBRyxLQUFLLGNBQWMsQ0FBQztZQUM1QixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLFFBQVE7WUFDcEQsQ0FBQyxJQUFJLENBQUMsR0FBRyxLQUFLLFlBQVksQ0FBQyxDQUFDO0lBQ2hDLENBQUM7Q0FFRixDQUFBO0FBNUZVO0lBQVIsS0FBSyxFQUFFO3NEQUE2QjtBQUQxQix1QkFBdUI7SUFMbkMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLG1CQUFtQjtRQUM3QixrK0VBQThDOztLQUUvQyxDQUFDO0dBQ1csdUJBQXVCLENBNkZuQztTQTdGWSx1QkFBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEdUd29EYXRhSW5wdXQgfSBmcm9tICcuLi8uLi9ncy1mb3Jtcy53aWRnZXRzJztcbmltcG9ydCB7IEdGaWVsZFZhbGlkYXRvclR5cGUsIEdGaWVsZFZhbHVlVHlwZSB9IGZyb20gJy4uLy4uL2dzLWZvcm1zLmVudW1zJztcbmltcG9ydCB7IEdzR2VuZXJpY0ZpZWxkQ29tcG9uZW50IH0gZnJvbSAnLi4vX2dlbmVyaWMtZmllbGQvX2dlbmVyaWMtZmllbGQuY29tcG9uZW50JztcblxuLy8gVE9ETzogYWRkIGVycm9yIHZhbGlkYXRvcnNcbmVudW0gVHdvRGF0YUlucHV0RXJyb3JzIHtcbiAgUklHSFRfTUlOLFxuICBMRUZUX01JTixcbiAgUkVRVUlSRURcbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZ3MtdHdvLWRhdGEtaW5wdXQnLFxuICB0ZW1wbGF0ZVVybDogJy4vdHdvLWRhdGEtaW5wdXQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi90d28tZGF0YS1pbnB1dC5jb21wb25lbnQuc2FzcyddXG59KVxuZXhwb3J0IGNsYXNzIEdzVHdvRGF0YUlucHV0Q29tcG9uZW50IGV4dGVuZHMgR3NHZW5lcmljRmllbGRDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBwdWJsaWMgZmllbGQ6IEdUd29EYXRhSW5wdXQ7XG5cbiAgcHVibGljIGxlZnRGaWVsZFZhbHVlOiBhbnk7XG4gIHB1YmxpYyByaWdodEZpZWxkVmFsdWU6IGFueTtcbiAgcHVibGljIGxlZnRGaWVsZFR5cGU6IGFueTtcbiAgcHVibGljIHJpZ2h0RmllbGRUeXBlOiBhbnk7XG4gIHB1YmxpYyBsZWZ0RmllbGRQbGFjZWhvbGRlcjogc3RyaW5nO1xuICBwdWJsaWMgcmlnaHRGaWVsZFBsYWNlaG9sZGVyOiBzdHJpbmc7XG4gIHB1YmxpYyB2YWx1ZVR5cGUgPSBHRmllbGRWYWx1ZVR5cGU7XG4gIHB1YmxpYyBmaWVsZFZhbGlkYXRvclR5cGUgPSBHRmllbGRWYWxpZGF0b3JUeXBlO1xuICBwdWJsaWMgcmlnaHRGaWVsZFRvdWNoZWQgPSBmYWxzZTtcbiAgcHVibGljIGxlZnRGaWVsZFRvdWNoZWQgPSBmYWxzZTtcblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMuZmllbGQuY3VycmVudFZhbHVlKSB7XG4gICAgICB0aGlzLmZpZWxkID0gY2hhbmdlcy5maWVsZC5jdXJyZW50VmFsdWU7XG5cbiAgICAgIGlmICh0aGlzLmZpZWxkLmNvbmZpZy52YWx1ZSkge1xuICAgICAgICB0aGlzLmxlZnRGaWVsZFZhbHVlID0gdGhpcy5maWVsZC5jb25maWcudmFsdWUubGVmdCB8fCBudWxsO1xuICAgICAgICB0aGlzLnJpZ2h0RmllbGRWYWx1ZSA9IHRoaXMuZmllbGQuY29uZmlnLnZhbHVlLnJpZ2h0IHx8IG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zKSB7XG4gICAgICAgIHRoaXMubGVmdEZpZWxkVHlwZSA9IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMubGVmdCA/IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMubGVmdC50eXBlIHx8IG51bGwgOiBudWxsO1xuICAgICAgICB0aGlzLnJpZ2h0RmllbGRUeXBlID0gdGhpcy5maWVsZC5jb25maWcub3B0aW9ucy5yaWdodCA/IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMucmlnaHQudHlwZSB8fCBudWxsIDogbnVsbDtcbiAgICAgICAgdGhpcy5sZWZ0RmllbGRQbGFjZWhvbGRlciA9IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMubGVmdCA/IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMubGVmdC5wbGFjZWhvbGRlciB8fCBudWxsIDogbnVsbDtcbiAgICAgICAgdGhpcy5yaWdodEZpZWxkUGxhY2Vob2xkZXIgPSB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLnJpZ2h0ID8gdGhpcy5maWVsZC5jb25maWcub3B0aW9ucy5yaWdodC5wbGFjZWhvbGRlciB8fCBudWxsIDogbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc2V0R3JpZCgpOiBvYmplY3Qge1xuICAgIGlmICghdGhpcy5maWVsZC5jb25maWcuZ3JpZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgZ3JpZCA9IHRoaXMuZmllbGQuY29uZmlnLmdyaWRbMF0gKyAnIG1heC1jb250ZW50ICcgKyB0aGlzLmZpZWxkLmNvbmZpZy5ncmlkWzFdO1xuICAgIHJldHVybiB7ICdncmlkLXRlbXBsYXRlLWNvbHVtbnMnOiBncmlkIH07XG4gIH1cblxuICBwdWJsaWMgb25VcGRhdGVWYWx1ZShyaWdodDogYm9vbGVhbikge1xuICAgIGlmICghdGhpcy5yaWdodEZpZWxkVG91Y2hlZCAmJiByaWdodCkge1xuICAgICAgdGhpcy5yaWdodEZpZWxkVG91Y2hlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmxlZnRGaWVsZFRvdWNoZWQgJiYgIXJpZ2h0KSB7XG4gICAgICB0aGlzLmxlZnRGaWVsZFRvdWNoZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZWRWYWx1ZSA9IHtcbiAgICAgIGxlZnQ6IHRoaXMubGVmdEZpZWxkVmFsdWUsXG4gICAgICByaWdodDogdGhpcy5yaWdodEZpZWxkVmFsdWVcbiAgICB9O1xuXG4gICAgaWYgKHVwZGF0ZWRWYWx1ZS5sZWZ0ICYmIHVwZGF0ZWRWYWx1ZS5yaWdodCkge1xuICAgICAgdGhpcy5mb3JtR3JvdXAuY29udHJvbHNbdGhpcy5maWVsZC5jb25maWcubW9kZWxdLnBhdGNoVmFsdWUodXBkYXRlZFZhbHVlKTtcbiAgICAgIHRoaXMuZm9ybUdyb3VwLmNvbnRyb2xzW3RoaXMuZmllbGQuY29uZmlnLm1vZGVsXS51cGRhdGVWYWx1ZUFuZFZhbGlkaXR5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZm9ybUdyb3VwLmNvbnRyb2xzW3RoaXMuZmllbGQuY29uZmlnLm1vZGVsXS5wYXRjaFZhbHVlKG51bGwpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBjaGVja01pbk1heFZhbGlkYXRvcihpbnB1dDogc3RyaW5nLCB2YWxpZGF0b3I6IHN0cmluZykge1xuICAgIGlmICh0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zICYmIHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnNbaW5wdXRdICYmIHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnNbaW5wdXRdLnR5cGUpIHtcbiAgICAgIGlmICh0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS50eXBlID09PSB0aGlzLnZhbHVlVHlwZS5OVU1CRVIpIHtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnNbaW5wdXRdLnZhbGlkYXRvcnNcbiAgICAgICAgICAmJiB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS52YWxpZGF0b3JzW3RoaXMuZmllbGRWYWxpZGF0b3JUeXBlW3ZhbGlkYXRvcl1dKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnNbaW5wdXRdLnZhbGlkYXRvcnNbdGhpcy5maWVsZFZhbGlkYXRvclR5cGVbdmFsaWRhdG9yXV07XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWVsZC5jb25maWcudmFsaWRhdG9ycyAmJiB0aGlzLmZpZWxkLmNvbmZpZy52YWxpZGF0b3JzW3RoaXMuZmllbGRWYWxpZGF0b3JUeXBlW3ZhbGlkYXRvcl1dKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY29uZmlnLnZhbGlkYXRvcnNbdGhpcy5maWVsZFZhbGlkYXRvclR5cGVbdmFsaWRhdG9yXV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHB1YmxpYyByZXF1aXJlZFRleHQocmlnaHQ6IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gcmlnaHRcbiAgICAgID8gdGhpcy5mb3Jtc1NlcnZpY2UuZ2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ0VSUl9SRVFVSVJFRF9UV09fREFUQV9SSUdIVCcpXG4gICAgICA6IHRoaXMuZm9ybXNTZXJ2aWNlLmdldFZhbGlkYXRpb25NZXNzYWdlKCdFUlJfUkVRVUlSRURfVFdPX0RBVEFfTEVGVCcpO1xuICB9XG5cbiAgcHVibGljIHZhbGlkYXRlUmVxdWlyZWQocmlnaHQ6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBpbnB1dCA9IHJpZ2h0ID8gJ3JpZ2h0JyA6ICdsZWZ0JztcblxuICAgIHJldHVybiB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS52YWxpZGF0b3JzICYmXG4gICAgICB0aGlzW2Ake2lucHV0fUZpZWxkVG91Y2hlZGBdICYmXG4gICAgICB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS52YWxpZGF0b3JzLnJlcXVpcmVkICYmXG4gICAgICAhdGhpc1tgJHtpbnB1dH1GaWVsZFZhbHVlYF07XG4gIH1cblxufVxuIl19