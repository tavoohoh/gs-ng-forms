import * as tslib_1 from "tslib";
import { Component, Input } from '@angular/core';
import { GFieldValidatorType, GFieldValueType } from '../../gs-forms.enums';
import { GsGenericFieldComponent } from '../_generic-field/_generic-field.component';
// TODO: add error validators
var TwoDataInputErrors;
(function (TwoDataInputErrors) {
    TwoDataInputErrors[TwoDataInputErrors["RIGHT_MIN"] = 0] = "RIGHT_MIN";
    TwoDataInputErrors[TwoDataInputErrors["LEFT_MIN"] = 1] = "LEFT_MIN";
    TwoDataInputErrors[TwoDataInputErrors["REQUIRED"] = 2] = "REQUIRED";
})(TwoDataInputErrors || (TwoDataInputErrors = {}));
var GsTwoDataInputComponent = /** @class */ (function (_super) {
    tslib_1.__extends(GsTwoDataInputComponent, _super);
    function GsTwoDataInputComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.valueType = GFieldValueType;
        _this.fieldValidatorType = GFieldValidatorType;
        _this.rightFieldTouched = false;
        _this.leftFieldTouched = false;
        return _this;
    }
    GsTwoDataInputComponent.prototype.ngOnChanges = function (changes) {
        if (changes.field.currentValue) {
            this.field = changes.field.currentValue;
            if (this.field.config.value) {
                this.leftFieldValue = this.field.config.value.left || null;
                this.rightFieldValue = this.field.config.value.right || null;
            }
            if (this.field.config.options) {
                this.leftFieldType = this.field.config.options.left ? this.field.config.options.left.type || null : null;
                this.rightFieldType = this.field.config.options.right ? this.field.config.options.right.type || null : null;
                this.leftFieldPlaceholder = this.field.config.options.left ? this.field.config.options.left.placeholder || null : null;
                this.rightFieldPlaceholder = this.field.config.options.right ? this.field.config.options.right.placeholder || null : null;
            }
        }
    };
    GsTwoDataInputComponent.prototype.setGrid = function () {
        if (!this.field.config.grid) {
            return null;
        }
        var grid = this.field.config.grid[0] + ' max-content ' + this.field.config.grid[1];
        return { 'grid-template-columns': grid };
    };
    GsTwoDataInputComponent.prototype.onUpdateValue = function (right) {
        if (!this.rightFieldTouched && right) {
            this.rightFieldTouched = true;
        }
        if (!this.leftFieldTouched && !right) {
            this.leftFieldTouched = true;
        }
        var updatedValue = {
            left: this.leftFieldValue,
            right: this.rightFieldValue
        };
        if (updatedValue.left && updatedValue.right) {
            this.formGroup.controls[this.field.config.model].patchValue(updatedValue);
            this.formGroup.controls[this.field.config.model].updateValueAndValidity();
        }
        else {
            this.formGroup.controls[this.field.config.model].patchValue(null);
        }
    };
    GsTwoDataInputComponent.prototype.checkMinMaxValidator = function (input, validator) {
        if (this.field.config.options && this.field.config.options[input] && this.field.config.options[input].type) {
            if (this.field.config.options[input].type === this.valueType.NUMBER) {
                if (this.field.config.options[input].validators
                    && this.field.config.options[input].validators[this.fieldValidatorType[validator]]) {
                    return this.field.config.options[input].validators[this.fieldValidatorType[validator]];
                }
                else if (this.field.config.validators && this.field.config.validators[this.fieldValidatorType[validator]]) {
                    return this.field.config.validators[this.fieldValidatorType[validator]];
                }
            }
        }
        return null;
    };
    GsTwoDataInputComponent.prototype.requiredText = function (right) {
        return right
            ? this.formsService.getValidationMessage('ERR_REQUIRED_TWO_DATA_RIGHT')
            : this.formsService.getValidationMessage('ERR_REQUIRED_TWO_DATA_LEFT');
    };
    GsTwoDataInputComponent.prototype.validateRequired = function (right) {
        var input = right ? 'right' : 'left';
        return this.field.config.options[input].validators &&
            this[input + "FieldTouched"] &&
            this.field.config.options[input].validators.required &&
            !this[input + "FieldValue"];
    };
    tslib_1.__decorate([
        Input()
    ], GsTwoDataInputComponent.prototype, "field", void 0);
    GsTwoDataInputComponent = tslib_1.__decorate([
        Component({
            selector: 'gs-two-data-input',
            template: "<div class=\"gs-field\" \n  [class.gs-field-has-error]=\"validateField() || validateRequired(false) || validateRequired(true)\">\n  \n  <label\n    class=\"gs-field-box\"\n    [class.gs-form-field-box-full]=\"field.config.label\">\n\n    <span\n      class=\"gs-field-label\"\n      *ngIf=\"field.config.label\">\n      {{ field.config.label | translate }}\n    </span>\n\n    <div class=\"gs-field-input gs-field-input-two-data\" [ngStyle]=\"setGrid()\">\n      <!-- left input -->\n      <input \n        class=\"gs-field-input gs-field-input-two-data-left\" \n        [placeholder]=\"leftFieldPlaceholder || '' | translate\"\n        [type]=\"leftFieldType === valueType.NUMBER ? 'number' : 'string'\"\n        [pattern]=\"leftFieldType === valueType.NUMBER ? '[0-9]*' : null\"\n        [inputmode]=\"leftFieldType === valueType.NUMBER ? 'numeric' : null\" \n        [decimal]=\"false\"\n        [gsDigitOnly]=\"leftFieldType === valueType.NUMBER\" \n        [autocomplete]=\"field.config.autocomplete || 'off'\"\n        [(ngModel)]=\"leftFieldValue\" \n        [min]=\"checkMinMaxValidator('left', 'MIN')\" \n        [max]=\"checkMinMaxValidator('left', 'MAX')\"\n        (keyup)=\"onUpdateValue(false)\"/>\n    \n      <!-- divider -->\n      <span class=\"gs-field-input-two-data-divider\">\n        {{ field.config.divider || '-' }}\n      </span>\n    \n      <!-- right input -->\n      <input \n        class=\"gs-field-input gs-field-input-two-data-right\" \n        [placeholder]=\"rightFieldPlaceholder || '' | translate\"\n        [type]=\"rightFieldType === valueType.NUMBER ? 'number' : 'string'\"\n        [pattern]=\"rightFieldType === valueType.NUMBER ? '[0-9]*' : null\"\n        [inputmode]=\"rightFieldType === valueType.NUMBER ? 'numeric' : null\" \n        [decimal]=\"false\"\n        [gsDigitOnly]=\"rightFieldType === valueType.NUMBER\" \n        [autocomplete]=\"field.config.autocomplete || 'off'\"\n        [min]=\"checkMinMaxValidator('right', 'MIN')\" \n        [max]=\"checkMinMaxValidator('right', 'MAX')\"\n        [(ngModel)]=\"rightFieldValue\"\n        (keyup)=\"onUpdateValue(true)\"/>\n    </div>\n  </label>\n\n  <span class=\"gs-field-error\" *ngIf=\"validateField()\">\n    {{ getFieldError(field.config.model) | translate }}\n  </span>\n  <span class=\"gs-field-error\"\n    *ngIf=\"validateRequired(false)\">\n    {{ requiredText(false) }}\n  </span>\n  <span class=\"gs-field-error\"\n    *ngIf=\"validateRequired(true)\">\n    {{ requiredText(true) }}\n  </span>\n</div>",
            styles: ["*{color:var(--gs-color-font,#706967);outline:0;box-sizing:border-box}input,option,select,textarea{border:none;outline:0;display:block;box-shadow:none;box-sizing:border-box}input::-webkit-input-placeholder,option::-webkit-input-placeholder,select::-webkit-input-placeholder,textarea::-webkit-input-placeholder{opacity:.5}input::-moz-placeholder,option::-moz-placeholder,select::-moz-placeholder,textarea::-moz-placeholder{opacity:.5}input::-ms-input-placeholder,option::-ms-input-placeholder,select::-ms-input-placeholder,textarea::-ms-input-placeholder{opacity:.5}input::placeholder,option::placeholder,select::placeholder,textarea::placeholder{opacity:.5}.disabled{opacity:var(--gs-disabled-opacity,.7);cursor:default;pointer-events:none}.button{-webkit-transition:.2s ease-in-out;transition:.2s ease-in-out;cursor:pointer;border:none;text-align:center;font-weight:700;outline:0;padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-color,#fff);background:var(--gs-primary-button-background,#b8b4b4);border-radius:var(--gs-primary-button-border-radius,1rem)}.button:hover{opacity:.8}.button.button-primary{padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-color,#fff);background:var(--gs-primary-button-background,#ff2426);border:none;border-radius:var(--gs-primary-button-border-radius,1rem)}.button.button-secondary{padding:var(--gs-primary-button-padding,1rem);color:var(--gs-primary-button-background,#ff2426);background:0 0;border:2px solid var(--gs-primary-button-background,#ff2426);border-radius:var(--gs-primary-button-border-radius,1rem)}*,input,select,textarea{font-size:var(--gs-font-size,.9rem);font-family:inherit;background-color:transparent}.gs-no-select{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gs-field{position:relative}.gs-field.gs-field-has-error .gs-field-box{border:2px solid #ff2426}.gs-field.gs-field-has-error .gs-field-error{display:block}.gs-field-box{border:2px solid var(--gs-input-border-color,none);display:-ms-grid;display:grid;background-color:var(--gs-input-background,#fff);padding:var(--gs-input-padding,12px);border-radius:var(--gs-input-border-radius,1rem);height:51px}.gs-field-box .gs-field-label{color:#706967;font-size:.6rem;font-weight:600;letter-spacing:.1em;line-height:1;text-transform:uppercase;-ms-grid-column:1;grid-column:1;-ms-grid-row:1;grid-row:1;color:var(--gs-input-color,#332927);opacity:.5}.gs-field-box .gs-field-input{outline:0;border:none;width:100%;margin:0;font-weight:600;font-size:1rem;line-height:1;padding:0;-ms-grid-column:1;grid-column:1;-ms-grid-row:2;grid-row:2}.gs-field-box .gs-field-input :focus,.gs-field-box .gs-field-input:focus{outline:0}.gs-field-box .gs-field-input::-webkit-input-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::-moz-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::-ms-input-placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-field-input::placeholder{color:var(--gs-input-color,#332927);opacity:.7;font-weight:400}.gs-field-box .gs-form-field_symbol{-ms-grid-column:2;grid-column:2;-ms-grid-row:1;-ms-grid-row-span:2;grid-row:1/3;-ms-grid-row-align:center;align-self:center;text-align:right}.gs-field-box.gs-field-box-full .gs-field-input{padding:.1rem 0 0}.gs-field-box.gs-input-check-box,.gs-field-box.gs-input-switch-box{-ms-grid-columns:1fr auto;grid-template-columns:1fr auto}.gs-field-box.gs-input-check-box .gs-field-label,.gs-field-box.gs-input-switch-box .gs-field-label{-ms-grid-column:1;grid-column:1;-ms-grid-row:1;grid-row:1;-ms-grid-row-align:center;align-self:center}.gs-field-box.gs-input-check-box .gs-input-check,.gs-field-box.gs-input-check-box .gs-input-switch,.gs-field-box.gs-input-switch-box .gs-input-check,.gs-field-box.gs-input-switch-box .gs-input-switch{-ms-grid-column:2;grid-column:2;-ms-grid-row:1;grid-row:1;-ms-grid-row-align:center;align-self:center}.gs-field-box.gs-field-box-icon{display:-ms-grid;display:grid;-ms-grid-columns:1fr 20px;grid-template-columns:1fr 20px}.gs-field-box.gs-field-box-icon .gs-field-icon{cursor:pointer;width:20px;fill:#706967;-ms-grid-column:2;grid-column:2;-ms-grid-row:1;-ms-grid-row-span:2;grid-row:1/3;-ms-grid-row-align:center;align-self:center}.gs-field-error,.gs-field-hint{font-size:.8rem;padding:.6rem 1rem;display:inline-block;margin-right:1rem}.gs-field-error{display:none;color:#ff2426}input{background:0 0;border:none;outline:0;margin:0;width:100%}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.gs-field-input-two-data{display:-ms-grid;display:grid;-ms-grid-columns:auto -webkit-max-content auto;-ms-grid-columns:auto max-content auto;grid-template-columns:auto -webkit-max-content auto;grid-template-columns:auto max-content auto}.gs-field-input-two-data .gs-field-input-two-data-input-divider,.gs-field-input-two-data .gs-field-input-two-data-left,.gs-field-input-two-data .gs-field-input-two-data-right{-ms-grid-row:1!important;grid-row:1!important}.gs-field-input-two-data .gs-field-input-two-data-left{padding-right:.5rem;text-align:right;-ms-grid-column:1!important;grid-column:1!important}.gs-field-input-two-data .gs-field-input-two-data-left::-webkit-input-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::-moz-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::-ms-input-placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-left::placeholder{text-align:left!important}.gs-field-input-two-data .gs-field-input-two-data-right{padding-left:.5rem;-ms-grid-column:3!important;grid-column:3!important}.gs-field-input-two-data .gs-field-input-two-data-divider{background-color:#e5e5e4;text-align:center;-ms-grid-row-align:center;align-self:center;padding:0 .5rem;-ms-grid-column:2!important;grid-column:2!important}"]
        })
    ], GsTwoDataInputComponent);
    return GsTwoDataInputComponent;
}(GsGenericFieldComponent));
export { GsTwoDataInputComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHdvLWRhdGEtaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzL25nLWZvcm1zLyIsInNvdXJjZXMiOlsibGliL2dzLWZpZWxkcy90d28tZGF0YS1pbnB1dC90d28tZGF0YS1pbnB1dC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUUzRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDNUUsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNENBQTRDLENBQUM7QUFFckYsNkJBQTZCO0FBQzdCLElBQUssa0JBSUo7QUFKRCxXQUFLLGtCQUFrQjtJQUNyQixxRUFBUyxDQUFBO0lBQ1QsbUVBQVEsQ0FBQTtJQUNSLG1FQUFRLENBQUE7QUFDVixDQUFDLEVBSkksa0JBQWtCLEtBQWxCLGtCQUFrQixRQUl0QjtBQU9EO0lBQTZDLG1EQUF1QjtJQUxwRTtRQUFBLHFFQWtHQztRQXBGUSxlQUFTLEdBQUcsZUFBZSxDQUFDO1FBQzVCLHdCQUFrQixHQUFHLG1CQUFtQixDQUFDO1FBQ3pDLHVCQUFpQixHQUFHLEtBQUssQ0FBQztRQUMxQixzQkFBZ0IsR0FBRyxLQUFLLENBQUM7O0lBaUZsQyxDQUFDO0lBL0VDLDZDQUFXLEdBQVgsVUFBWSxPQUFzQjtRQUNoQyxJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFO1lBQzlCLElBQUksQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUM7WUFFeEMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUU7Z0JBQzNCLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUM7Z0JBQzNELElB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QUFDLENBQUM7aUJBQ3pFO2FBQ0Y7U0FDRjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVNLDhDQUFZLEdBQW5CLFVBQW9CLEtBQWM7UUFDaEMsT0FBTyxLQUFLO1lBQ1YsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsNkJBQTZCLENBQUM7WUFDdkUsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsNEJBQTRCLENBQUMsQ0FBQztJQUMzRSxDQUFDO0lBRU0sa0RBQWdCLEdBQXZCLFVBQXdCLEtBQWM7UUFDcEMsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUV2QyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxVQUFVO1lBQ2hELElBQUksQ0FBSSxLQUFLLGlCQUFjLENBQUM7WUFDNUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsQ0FBQyxRQUFRO1lBQ3BELENBQUMsSUFBSSxDQUFJLEtBQUssZUFBWSxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQTFGUTtRQUFSLEtBQUssRUFBRTswREFBNkI7SUFEMUIsdUJBQXVCO1FBTG5DLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxtQkFBbUI7WUFDN0IsaytFQUE4Qzs7U0FFL0MsQ0FBQztPQUNXLHVCQUF1QixDQTZGbkM7SUFBRCw4QkFBQztDQUFBLEFBN0ZELENBQTZDLHVCQUF1QixHQTZGbkU7U0E3RlksdUJBQXVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBHVHdvRGF0YUlucHV0IH0gZnJvbSAnLi4vLi4vZ3MtZm9ybXMud2lkZ2V0cyc7XG5pbXBvcnQgeyBHRmllbGRWYWxpZGF0b3JUeXBlLCBHRmllbGRWYWx1ZVR5cGUgfSBmcm9tICcuLi8uLi9ncy1mb3Jtcy5lbnVtcyc7XG5pbXBvcnQgeyBHc0dlbmVyaWNGaWVsZENvbXBvbmVudCB9IGZyb20gJy4uL19nZW5lcmljLWZpZWxkL19nZW5lcmljLWZpZWxkLmNvbXBvbmVudCc7XG5cbi8vIFRPRE86IGFkZCBlcnJvciB2YWxpZGF0b3JzXG5lbnVtIFR3b0RhdGFJbnB1dEVycm9ycyB7XG4gIFJJR0hUX01JTixcbiAgTEVGVF9NSU4sXG4gIFJFUVVJUkVEXG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2dzLXR3by1kYXRhLWlucHV0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3R3by1kYXRhLWlucHV0LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdHdvLWRhdGEtaW5wdXQuY29tcG9uZW50LnNhc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBHc1R3b0RhdGFJbnB1dENvbXBvbmVudCBleHRlbmRzIEdzR2VuZXJpY0ZpZWxkQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgQElucHV0KCkgcHVibGljIGZpZWxkOiBHVHdvRGF0YUlucHV0O1xuXG4gIHB1YmxpYyBsZWZ0RmllbGRWYWx1ZTogYW55O1xuICBwdWJsaWMgcmlnaHRGaWVsZFZhbHVlOiBhbnk7XG4gIHB1YmxpYyBsZWZ0RmllbGRUeXBlOiBhbnk7XG4gIHB1YmxpYyByaWdodEZpZWxkVHlwZTogYW55O1xuICBwdWJsaWMgbGVmdEZpZWxkUGxhY2Vob2xkZXI6IHN0cmluZztcbiAgcHVibGljIHJpZ2h0RmllbGRQbGFjZWhvbGRlcjogc3RyaW5nO1xuICBwdWJsaWMgdmFsdWVUeXBlID0gR0ZpZWxkVmFsdWVUeXBlO1xuICBwdWJsaWMgZmllbGRWYWxpZGF0b3JUeXBlID0gR0ZpZWxkVmFsaWRhdG9yVHlwZTtcbiAgcHVibGljIHJpZ2h0RmllbGRUb3VjaGVkID0gZmFsc2U7XG4gIHB1YmxpYyBsZWZ0RmllbGRUb3VjaGVkID0gZmFsc2U7XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLmZpZWxkLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgdGhpcy5maWVsZCA9IGNoYW5nZXMuZmllbGQuY3VycmVudFZhbHVlO1xuXG4gICAgICBpZiAodGhpcy5maWVsZC5jb25maWcudmFsdWUpIHtcbiAgICAgICAgdGhpcy5sZWZ0RmllbGRWYWx1ZSA9IHRoaXMuZmllbGQuY29uZmlnLnZhbHVlLmxlZnQgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5yaWdodEZpZWxkVmFsdWUgPSB0aGlzLmZpZWxkLmNvbmZpZy52YWx1ZS5yaWdodCB8fCBudWxsO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5maWVsZC5jb25maWcub3B0aW9ucykge1xuICAgICAgICB0aGlzLmxlZnRGaWVsZFR5cGUgPSB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLmxlZnQgPyB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLmxlZnQudHlwZSB8fCBudWxsIDogbnVsbDtcbiAgICAgICAgdGhpcy5yaWdodEZpZWxkVHlwZSA9IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMucmlnaHQgPyB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLnJpZ2h0LnR5cGUgfHwgbnVsbCA6IG51bGw7XG4gICAgICAgIHRoaXMubGVmdEZpZWxkUGxhY2Vob2xkZXIgPSB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLmxlZnQgPyB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zLmxlZnQucGxhY2Vob2xkZXIgfHwgbnVsbCA6IG51bGw7XG4gICAgICAgIHRoaXMucmlnaHRGaWVsZFBsYWNlaG9sZGVyID0gdGhpcy5maWVsZC5jb25maWcub3B0aW9ucy5yaWdodCA/IHRoaXMuZmllbGQuY29uZmlnLm9wdGlvbnMucmlnaHQucGxhY2Vob2xkZXIgfHwgbnVsbCA6IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHNldEdyaWQoKTogb2JqZWN0IHtcbiAgICBpZiAoIXRoaXMuZmllbGQuY29uZmlnLmdyaWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGdyaWQgPSB0aGlzLmZpZWxkLmNvbmZpZy5ncmlkWzBdICsgJyBtYXgtY29udGVudCAnICsgdGhpcy5maWVsZC5jb25maWcuZ3JpZFsxXTtcbiAgICByZXR1cm4geyAnZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zJzogZ3JpZCB9O1xuICB9XG5cbiAgcHVibGljIG9uVXBkYXRlVmFsdWUocmlnaHQ6IGJvb2xlYW4pIHtcbiAgICBpZiAoIXRoaXMucmlnaHRGaWVsZFRvdWNoZWQgJiYgcmlnaHQpIHtcbiAgICAgIHRoaXMucmlnaHRGaWVsZFRvdWNoZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5sZWZ0RmllbGRUb3VjaGVkICYmICFyaWdodCkge1xuICAgICAgdGhpcy5sZWZ0RmllbGRUb3VjaGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVkVmFsdWUgPSB7XG4gICAgICBsZWZ0OiB0aGlzLmxlZnRGaWVsZFZhbHVlLFxuICAgICAgcmlnaHQ6IHRoaXMucmlnaHRGaWVsZFZhbHVlXG4gICAgfTtcblxuICAgIGlmICh1cGRhdGVkVmFsdWUubGVmdCAmJiB1cGRhdGVkVmFsdWUucmlnaHQpIHtcbiAgICAgIHRoaXMuZm9ybUdyb3VwLmNvbnRyb2xzW3RoaXMuZmllbGQuY29uZmlnLm1vZGVsXS5wYXRjaFZhbHVlKHVwZGF0ZWRWYWx1ZSk7XG4gICAgICB0aGlzLmZvcm1Hcm91cC5jb250cm9sc1t0aGlzLmZpZWxkLmNvbmZpZy5tb2RlbF0udXBkYXRlVmFsdWVBbmRWYWxpZGl0eSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmZvcm1Hcm91cC5jb250cm9sc1t0aGlzLmZpZWxkLmNvbmZpZy5tb2RlbF0ucGF0Y2hWYWx1ZShudWxsKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgY2hlY2tNaW5NYXhWYWxpZGF0b3IoaW5wdXQ6IHN0cmluZywgdmFsaWRhdG9yOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5maWVsZC5jb25maWcub3B0aW9ucyAmJiB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XSAmJiB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS50eXBlKSB7XG4gICAgICBpZiAodGhpcy5maWVsZC5jb25maWcub3B0aW9uc1tpbnB1dF0udHlwZSA9PT0gdGhpcy52YWx1ZVR5cGUuTlVNQkVSKSB7XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS52YWxpZGF0b3JzXG4gICAgICAgICAgJiYgdGhpcy5maWVsZC5jb25maWcub3B0aW9uc1tpbnB1dF0udmFsaWRhdG9yc1t0aGlzLmZpZWxkVmFsaWRhdG9yVHlwZVt2YWxpZGF0b3JdXSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNvbmZpZy5vcHRpb25zW2lucHV0XS52YWxpZGF0b3JzW3RoaXMuZmllbGRWYWxpZGF0b3JUeXBlW3ZhbGlkYXRvcl1dO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmllbGQuY29uZmlnLnZhbGlkYXRvcnMgJiYgdGhpcy5maWVsZC5jb25maWcudmFsaWRhdG9yc1t0aGlzLmZpZWxkVmFsaWRhdG9yVHlwZVt2YWxpZGF0b3JdXSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNvbmZpZy52YWxpZGF0b3JzW3RoaXMuZmllbGRWYWxpZGF0b3JUeXBlW3ZhbGlkYXRvcl1dO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwdWJsaWMgcmVxdWlyZWRUZXh0KHJpZ2h0OiBib29sZWFuKSB7XG4gICAgcmV0dXJuIHJpZ2h0XG4gICAgICA/IHRoaXMuZm9ybXNTZXJ2aWNlLmdldFZhbGlkYXRpb25NZXNzYWdlKCdFUlJfUkVRVUlSRURfVFdPX0RBVEFfUklHSFQnKVxuICAgICAgOiB0aGlzLmZvcm1zU2VydmljZS5nZXRWYWxpZGF0aW9uTWVzc2FnZSgnRVJSX1JFUVVJUkVEX1RXT19EQVRBX0xFRlQnKTtcbiAgfVxuXG4gIHB1YmxpYyB2YWxpZGF0ZVJlcXVpcmVkKHJpZ2h0OiBib29sZWFuKSB7XG4gICAgY29uc3QgaW5wdXQgPSByaWdodCA/ICdyaWdodCcgOiAnbGVmdCc7XG5cbiAgICByZXR1cm4gdGhpcy5maWVsZC5jb25maWcub3B0aW9uc1tpbnB1dF0udmFsaWRhdG9ycyAmJlxuICAgICAgdGhpc1tgJHtpbnB1dH1GaWVsZFRvdWNoZWRgXSAmJlxuICAgICAgdGhpcy5maWVsZC5jb25maWcub3B0aW9uc1tpbnB1dF0udmFsaWRhdG9ycy5yZXF1aXJlZCAmJlxuICAgICAgIXRoaXNbYCR7aW5wdXR9RmllbGRWYWx1ZWBdO1xuICB9XG5cbn1cbiJdfQ==